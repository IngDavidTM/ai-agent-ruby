<div class="liquid-background" style="background: url('https://images.unsplash.com/photo-1618005182384-a83a8bd57fbe?q=80&w=2564&auto=format&fit=crop') no-repeat center center/cover;">
</div>

<!-- SVG Filter for Liquid Distortion -->
<svg style="position: absolute; width: 0; height: 0;">
  <defs>
    <filter id="liquid-distortion">
      <feTurbulence type="turbulence" baseFrequency="0.01 0.02" numOctaves="3" result="noise" seed="1"/>
      <feDisplacementMap in="SourceGraphic" in2="noise" scale="15" xChannelSelector="R" yChannelSelector="G" />
      <feGaussianBlur stdDeviation="0.5" />
      <feComponentTransfer>
        <feFuncA type="linear" slope="0.9"/>
      </feComponentTransfer>
      <feMerge>
        <feMergeNode />
      </feMerge>
    </filter>
    
    <!-- High Gloss Glass Filter -->
    <filter id="glass-gloss">
       <feSpecularLighting result="spec" specularConstant="1.2" specularExponent="30" lighting-color="#fff">
        <fePointLight x="-5000" y="-10000" z="20000"/>
      </feSpecularLighting>
      <feComposite in="spec" in2="SourceGraphic" operator="in" result="shine"/>
      <feComposite in="SourceGraphic" in2="shine" operator="arithmetic" k1="0" k2="1" k3="1" k4="0"/>
    </filter>
  </defs>
</svg>

<div class="glass-interface">
  <header class="glass-header">
    <div class="header-content">
      <span class="status-dot"></span>
      <h1>Agent <span>OS</span></h1>
    </div>
  </header>

  <div class="chat-area" id="chat-container">
    <% @messages.each do |message| %>
      <div class="message-wrapper <%= message.role %>">
        <div class="message-bubble">
          <%= message.content %>
        </div>
        <span class="message-time">Now</span>
      </div>
    <% end %>
  </div>

  <div class="glass-input-area">
    <%= form_with url: agents_chat_path, local: true, class: "chat-form" do |form| %>
      <%= form.hidden_field :conversation_id, value: @conversation.id %>
      
      <div class="input-wrapper">
        <%= form.text_field :message, placeholder: "Ask anything...", class: "glass-input", autocomplete: "off" %>
        <button type="submit" class="glass-button">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 4L12 20M12 4L6 10M12 4L18 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>
    <% end %>
  </div>
</div>

<script>
  // Auto-scroll to bottom of chat
  const chatContainer = document.getElementById('chat-container');
  chatContainer.scrollTop = chatContainer.scrollHeight;
</script>
